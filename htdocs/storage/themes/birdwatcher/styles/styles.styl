// Author: Artem Sapegin, http://sapegin.me, 2013

body {
	background:bg_color;
	color:base_color;
	line-height:1.5;
	padding:spacer 2*spacer;
	font-size:normal_font;
	if (max_width) {
		max-width:max_width;
		margin-left:auto;
		margin-right:auto;
	}
}


// Fonts

body { font-family:"Helvetica Neue", Arial, sans-serif; }


// Headers: alpha, beta, gamma, delta, epsilon, epsilon

.alpha {
	font-size:48px;
	font-weight:normal;
	line-height:1.1;
}

.beta {
	font-size:32px;
	font-weight:normal;
	line-height:1.1;
}

.gamma {
	font-size:24px;
	font-weight:normal;
	line-height:1.1;
}

.delta {
	font-size:content_font;
	font-weight:bold;
	line-height:1.3;
}


// Text

.text {
	a {
		@extend .link;
	}

	p,
	ul,
	ol {
		space(2);
	}

	h3 {
		@extend .delta;
		space();
	}

	blockquote {
		margin-left:4*spacer;
		margin-right:4*spacer;
		font-size:90%;

		cite {
			font-style:italic;
		}
	}
}

// Fotorama tweaks.
.fotorama__arr {
	display:none !important;
}

.header {
	clearfix();
	space(2);
}
.page_content .header {
	display:none;
}

.logo {
	float:left;
	font-weight:normal;

	&,
	&__link,
	&__link:link,
	&__link:visited,
	&__link:hover,
	&__link:active,
	&__link:focus {
		font-size:normal_font;
		color:base_color;
	}
}
.page_inverted-head,
.page_content {
	.logo,
	.logo__link {
		tweak-inverted-text();
		color:light_hover_color;
	}
}
.page_content {
	.logo__link {
		color:light_color;
	}
	.logo__link:hover,
	.logo__link:active,
	.logo__link:focus, {
		color:light_hover_color;
	}
}

.nav {
	float:right;

	// I have to use tag names here because Koken don’t provide any ability to change it

	li {
		display:inline-block;
		margin-left:.8em;
		&:first-child {
			margin-left:0;
		}
	}

	span,
	a,
	a:link,
	a:visited,
	a:hover,
	a:active,
	a:focus {
		font-size:normal_font;
		color:base_color;
	}

	.k-nav-current {
		font-weight:bold;
	}
}
.page_inverted-head .nav a,
.page_inverted-head .nav span {
	& {
		tweak-inverted-text();
		color:light_hover_color;
	}
}

.footer {
	padding:0;
	font-size:small_font;

	.page_album & {
		padding:0 2*spacer;
	}
	.page_index &,
	.page_content & {
		display:none;
	}
}

.is-fullscreen {
	overflow:hidden;
}

.page {
	&_content {
		background:photo_bg_color;
	}

	&_content,
	&_album {
		.content {
			max-width:100%;
		}
	}

	&_index {
		padding:0;
	}
}
@media (min-width:1025px) {
	.page_index {
		background:photo_bg_color;
	}
}


lightbox_button_width = 50px;
lightbox_button_height = 40px;
header_height = 40px;

lightbox-button-transition() {
	transition:all 333ms cubic-bezier(0.1, 0.25, 0.25, 1);
}

lightbox-button-glow() {
	color:light_hover_color;
	text-shadow:0 0 10px hsla(209, 75%, 65%, 1);
}

.lightbox-button {
	lightbox-button-transition();
	width:lightbox_button_width;
	height:lightbox_button_height;
	line-height:lightbox_button_height;
	color:light_color;
	text-align:center;
	text-decoration:none;
	cursor:pointer;
	text-shadow:0 0 4px black(.5);

	&:hover {
		lightbox-button-glow()
	}

	&.is-disabled,
	&.is-disabled:hover {
		color:white(.25);
		text-shadow:0 0 4px black(.25);
		cursor:default;
	}
}

.lightbox {
	position:absolute;
	top:0;
	bottom:0;
	left:0;
	right:0;

	&__logo {
		position:absolute;
		left:2*spacer;
		top:spacer;
	}

	&__gallery,
	&__saver {
		position:absolute;
		top:header_height;
		bottom:spacer;
		left:0;
		right:0;
	}

	&__saver {
		opacity:0;
	}

	&__image {
		max-width:1600px;
		height:100%;
		margin:0 auto;
		background-repeat:no-repeat;
		background-position:center center;
		background-size:contain;
		.is-ok & {
			background:none !important;
		}
	}

	&__controls,
	&__arrow,
	&__close {
		z-index:9999;
		opacity:0;
	}

	&__controls {
		lightbox-button-transition();
		position:absolute;
		left:0;
		bottom:0;
	}

	&__arrow {
		position:absolute;
		top:50%;
		margin-top:(-(lightbox_button_height/2));
		text-align:center;

		&_left {
			left:0;
		}
		&_right {
			right:0;
		}
		.icon {
			font-size:35px;
		}
	}

	&__close {
		position:absolute;
		top:0;
		right:0;
		width:50px;
		.icon {
			margin-top:.15em;
			font-size:17px;
		}
	}

	&__close-tooltip,
	&__close:hover &__close-tooltip {
		tweak-inverted-text();
		position:absolute;
		top:spacer;
		right:50px;
		line-height:1.5;
		color:light_color;
		text-decoration:underline;
		text-align:right;
		white-space:nowrap;
		text-shadow:none;
		display:none;
	}
	&__close:hover &__close-tooltip {
		display:block;
	}

	&:hover &__controls,
	&:hover &__arrow,
	&:hover &__close {
		opacity:1;
	}
}

.lightbox-pane {
	&__button {
		text-align:center;
		cursor:default;

		.icon {
			font-size:20px;
		}
		.icon_info {
			margin-left:-.5ex;
		}
	}

	&__popup {
		display:none;
		position:absolute;
		left:lightbox_button_width;
		bottom:0;
		padding:spacer;
		background:bg_color;
	}

	&:hover &__button {
		lightbox-button-glow();
	}
	&:hover &__popup {
		display:block;
	}
}

.photo-info {
	width:500px;
	width:40vw;

	&__header {
		space(2);
	}

	&__title {
		space(0.5)
		@extend .beta;
	}

	&__caption {
		font-size:normal_font;
	}

	&__meta,
	&__tags,
	&__copyright {
		space();
		font-size:small_font;

		&:last-child {
			margin-bottom:0;
		}
	}
}

.thumbnails {
	clearfix();
	margin:0 (-(spacer / 2)) spacer*2;

	&__item {
		float:left;
		margin:0 (spacer / 2) spacer;
	}
}


.thumbnail {
	display:block;
	overflow:hidden;

	&__img {
		display:block;
	}
}

.entry,
.entry-content {
	font-size:content_font;

	div + p {
		margin-top:4*spacer;
	}

	p,
	ul,
	ol {
		line-height:1.6;
	}
}

.entry-header {
	space(3);
}

.entry-title {
	@extend .alpha;
	margin-bottom:5px;

	&__link {
		&,
		&:link,
		&:visited,
		&:hover,
		&:active,
		&:focus {
			color:base_color;
			text-decoration:none;
		}
		&:hover,
		&:active,
		&:focus {
			border-bottom:2px solid;
		}
	}

	&_excerpt,
	&_excerpt-photo {
		@extend .beta;
	}

	&_excerpt-photo {
		space(2);

		.entry-title__link {
			&,
			&:link,
			&:visited,
			&:hover,
			&:active,
			&:focus {
				color:bg_color;
			}
		}
	}
}

.entry-content {
	space(4);
}

.entry-excerpt,
.entry-links {
	space(0.5);
	font-size:small_font;

	&:last-child {
		space(0);
	}
}

.entry-pubdate {
	font-size:small_font;
}

.entry-tags {
	font-size:small_font;
}

.entry-instagrams,
.entry-triptych,
.about-triptych {
	layout-row();
	space(2);
	margin-top:(-(spacer));

	&__item {
		layout-nth(3);
		margin-top:spacer;
		margin-bottom:spacer;
	}

	&__photo {
		max-width:100%;
		height:auto;
	}
}

.about-triptych {
	margin:(-(spacer)) (-(spacer)) spacer;

	&__item {
		position:relative;
		height:size = 328px;
		width:size + 2*spacer;
	}

	&__photo {
		position:absolute;
		top:0;
		transition:opacity .5s ease-in-sine;
		&.is-hidden {
			display:block;
			opacity:0;
		}
	}
}

.entry-photo {
	space(3);

	& + &,
	.l-row + &,
	& + .l-row {
		margin-top:(-(spacer));
	}
	.l-row & {
		margin-top:0;
	}

	&__photo {
		max-width:100%;
		height:auto;
	}

	&__title {
		font-size:small_font;
	}
}

.entry-tip {
	position:relative;
	font-size:small_font;

	&:before {
		content:"\261e";
		position:absolute;
		top:-.25em;
		left:-(1em + .3em);
		width:1em;
		text-align:right;
		font-size:23px;
	}
}

.entry-figure-right {
	float:right;
	margin-left:grid_gutter;
}


.essay {
	space(6);

	&_photo {
		tweak-inverted-text();
		margin-left:(-(2*spacer));
		margin-right:(-(2*spacer));
		padding:8*spacer 2*spacer;
		background:base_color;
		color:bg_color;

		.essay__content a,
		.essay__meta a {
			&,
			&:link,
			&:visited {
				color:light_color;
			}
			&:hover,
			&:active,
			&:focus {
				color:bg_color;
			}
		}
	}

	&_photo + &_photo {
		margin-top:(-(14*spacer));
	}

	&__header {
		space(2);
	}

	&__content {
		space(2);
	}

	&__pubdate {
		display:inline-block;
		margin-right:1em;
	}
}

.blog-tags {
	space(4);

	&__item {
		display:inline-block;
		margin-right:1em;
		font-size:normal_font;
	}

	&__counter {
		margin-left:.25em;
		font-size:small_font;
	}
}

.pagination {
	space(4);

	&__link {
		margin-right:.5em;
		font-size:content_font;
	}
}


.albums {
	layout-row();
	space(4);
}

.album-thumbnail {
	layout-nth(4);
	space(2);

	&__link {
		&,
		&:link,
		&:visited,
		&:hover,
		&:active,
		&:focus {
			text-decoration:none;
			color:base_color;
		}
	}

	&__img {
		margin-bottom:5px;
	}

	&__title {
		@extend .gamma;
	}

	&__summary {
		font-size:small_font;
	}
}


.book-review {
	space(4);

	&__title {
		@extend .gamma;
		margin-bottom:10px;
	}

	&__year {
		margin-left:.5em;
		font-size:16px;
	}

	&__translation {
		margin-bottom:14px;
		font-size:normal_font;
		font-weight:normal;
		font-style:italic;
	}

	&__img {
		max-width:120px;
		margin-top:7px;
		margin-bottom:spacer;
	}

	&__rating {
		position:relative;

		&,
		&:before,
		i,
		i:before,
		i:after {
			height:1.2em;
			line-height:1;
			vertical-align:top;
			font-size:17px;
			font-style:normal;
			letter-spacing:.2ex;
		}

		&:before,
		i {
			position:absolute;
			left:50%;
			top:0;
			margin-left:-5.2ex;
		}

		&:before {
			color:#ccc;
			color:rgba(base_color,.25);
		}
		i {
			color:base_color;
		}
		&:before,
		&_5 i:before {
			content:"★★★★★";
		}
		&_4 i:before,
		&_4-5 i:before {
			content:"★★★★";
		}
		&_3 i:before,
		&_3-5 i:before {
			content:"★★★";
		}
		&_2 i:before,
		&_2-5 i:before {
			content:"★★";
		}
		&_1 i:before,
		&_1-5 i:before {
			content:"★";
		}
		&_4-5 i:after,
		&_3-5 i:after,
		&_2-5 i:after,
		&_1-5 i:after,
		&_0-5 i:after {
			content:"★";
			display:inline-block;
			overflow:hidden;
			width:1.1ex;  // HACK
		}
	}
}


.book-review {
	display:none;
}
.tag_all .book-review {
	display:block;
}
for tag in "best" "good" "russian" "english" {
	.tag_{tag} .book-review_tag_{tag} {
		display:block;
	}
}


.filter {
	space(3);

	&__tag {
		margin-right:.5em;

		&.is-active {
			&,
			&:link,
			&:visited,
			&:hover,
			&:active,
			&:focus {
				font-weight:bold;
				color:base_color;
				text-decoration:none;
				cursor:default;
			}
		}
	}
}

.quote {
	space(4);

	&__text {
		space(2);
		font-style:normal_font;
	}

	&__meta {
		font-size:small_font;
	}
}


.index {
	position:fixed;
	top:0;
	left:0;
	width:100%;

	.header-i {
		position:relative;
		z-index:9999999;
	}

	.header {
		position:absolute;
		left:0;
		right:0;
		padding:spacer;
		margin:0;
		max-width:none;
		text-shadow:0 0 3px black(.5);
	}
}

.index-content {

	&-i {
		margin-top:100vh;
	}

	&-i-i {
		position:relative;
		margin-top:(-(normal_font*2.5));
		margin-left:(-(spacer*0.5));
		margin-right:(-(spacer*0.5));
		padding:spacer*1.5;
		background:bg_color;
		box-shadow:0 0 6px black(.25);
	}
}

.articles-list {
	&__title {
		@extend .gamma;
		space();

		&_index {
			font-size:normal_font;
		}
	}

	&__item {
		margin-bottom:(spacer/2);
		font-size:normal_font;

		&:before {
			display:none;
		}
	}

	&__description {
		font-size:small_font;
	}
}

.index-about {
	space();
	font-size:small_font;
}

@media (max-width:1024px) {
	.index {
		position:static;
	}
	.index-content {

		&-i {
			margin-top:0 !important;  // important to overwrite value set by JS
		}
		&-i-i {
			box-shadow:none;
		}
	}
}


// About page

.page_about {

}

.about-splash {
	height:(500px - 55px);  // Photo height - header height

	&-i {
		position:fixed;
		top:0;
		left:0;
		right:0;
		height:500px;
		overflow:hidden;
		z-index:-1;
	}

	&__img {
		height:inherit;
		background:url("/images/about/splash.jpg") center center;
	}
}
@media (min-width:1601px) {
	.about-splash {
		&__img {
			background-size:cover;
		}
	}
}

.about-content {
	margin-left:(-(2*spacer));
	margin-right:(-(2*spacer));
	padding:4*spacer 2*spacer spacer;
	background:bg_color;
}

.about-subtitle {
	@extend .delta;
	space();
}

.about-links {
	space(2);

	&__item {
		&:before {
			display:none;
		}
	}
}

.about-list {
	space(2);

	&__item {
		font-size:normal_font;

		&_obsolete,
		&_obsolete-first {
			font-size:small_font;
		}

		&_obsolete {
			margin-top:spacer;
		}

		&:before {
			display:none;
		}
	}
}

.about-site,
.about-copyrights {
	space(2);
	font-size:small_font;
}
